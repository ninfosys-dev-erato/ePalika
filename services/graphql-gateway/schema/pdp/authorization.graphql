# PDP (Policy Decision Point) Service Schema

extend type Query {
  # Get health status of PDP service
  pdpHealth: HealthStatus!

  # Check authorization
  checkAuthorization(input: AuthCheckInput!): AuthCheckResponse!
}

# Input types
input AuthCheckInput {
  user: String!
  relation: String!
  object: String!
}

# Response types
type AuthCheckResponse implements Response {
  success: Boolean!
  message: String!
  allowed: Boolean!
  reason: String
}
